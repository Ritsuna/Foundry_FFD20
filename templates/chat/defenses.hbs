<div class="ffd20lnrw chat-card defense-card" data-actor-id="{{actor._id}}" {{#if tokenId}}data-token-id="{{tokenId}}"{{/if}}>
  <header class="card-header flexrow">
    <h3 class="actor-name">{{name}} - Defenses</h3>
  </header>

  <div>
    {{#if ac}}
    <div class="defense ac">
      <table>
        <thead>
          <tr>
            <th>{{localize "ffd20lnrw.ACNormal"}}</th>
            <th>{{localize "ffd20lnrw.ACTouch"}}</th>
            <th>{{localize "ffd20lnrw.ACFlatFooted"}}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{ac.normal}}</td>
            <td>{{ac.touch}}</td>
            <td>{{ac.flatFooted}}</td>
          </tr>
        </tbody>
      </table>
    </div>

    {{#if ac.notes}}
    <div class="flexcol property-group">
      <label>{{localize "ffd20lnrw.ACNotes"}}</label>
      <div class="flexrow">
        {{#each ac.notes as |v|}}
        <span class="tag">{{{v}}}</span>
        {{/each}}
      </div>
    </div>
    {{/if}}
    {{/if}}

    {{#if cmd}}
    <div class="defense cmd">
      <table>
        <thead>
          <tr>
            <th>{{localize "ffd20lnrw.CMDAbbr"}}</th>
            <th>{{localize "ffd20lnrw.CMDFlatFooted"}}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{cmd.normal}}</td>
            <td>{{cmd.flatFooted}}</td>
          </tr>
        </tbody>
      </table>
    </div>

    {{#if cmd.notes}}
    <div class="flexcol property-group">
      <label>{{localize "ffd20lnrw.CMDNotes"}}</label>
      <div class="flexrow">
        {{#each cmd.notes as |v|}}
        <span class="tag">{{{v}}}</span>
        {{/each}}
      </div>
    </div>
    {{/if}}
    {{/if}}

    {{#if misc.sr}}
    <div class="defense misc">
      <table>
        <thead>
          <tr>
            <th>{{localize "ffd20lnrw.SpellResistance"}}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{misc.sr}}</td>
          </tr>
        </tbody>
      </table>
    </div>

    {{#if misc.srNotes}}
    <div class="flexcol property-group">
      <label>{{localize "ffd20lnrw.SpellResistanceNotes"}}</label>
      <div class="flexrow">
        {{#each misc.srNotes as |v|}}
        <span class="tag">{{{v}}}</span>
        {{/each}}
      </div>
    </div>
    {{/if}}
    {{/if}}

    {{#if misc.drNotes}}
    <div class="flexcol property-group">
      <label>{{localize "ffd20lnrw.DamRed"}}</label>
      <div class="flexrow">
        {{#each misc.drNotes as |v|}}
        <span class="tag">{{{v}}}</span>
        {{/each}}
      </div>
    </div>
    {{/if}}

    {{#if misc.energyResistance}}
    <div class="flexcol property-group">
      <label>{{localize "ffd20lnrw.EnRes"}}</label>
      <div class="flexrow">
        {{#each misc.energyResistance as |v|}}
        <span class="tag">{{{v}}}</span>
        {{/each}}
      </div>
    </div>
    {{/if}}

    {{#if regen}}
    <div class="defense regen">
      <table>
        <thead>
          <tr>
            <th>{{localize "ffd20lnrw.Regeneration"}}</th>
            <th>{{localize "ffd20lnrw.FastHealing"}}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{#if regen.regen}}{{regen.regen}}{{else}}{{localize "ffd20lnrw.NonApplicable"}}{{/if}}</td>
            <td>{{#if regen.fastHealing}}{{regen.fastHealing}}{{else}}{{localize "ffd20lnrw.NonApplicable"}}{{/if}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    {{/if}}

    <div class="saving-throws flexrow">
      <button data-action="defense-save" data-save="fort">{{localize "ffd20lnrw.SavingThrowFort"}}</button>
      <button data-action="defense-save" data-save="ref">{{localize "ffd20lnrw.SavingThrowRef"}}</button>
      <button data-action="defense-save" data-save="will">{{localize "ffd20lnrw.SavingThrowWill"}}</button>
    </div>
  </div>
</div>
